<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>청소당번 랜덤 추첨기</title>
  <!-- Bootstrap CSS CDN -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- SweetAlert2 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" rel="stylesheet">
  <style>
    /* Tailwind와 Bootstrap이 충돌하지 않게, 필요한 커스텀만 작성 */
    body { @apply bg-slate-900 text-gray-200 min-h-screen flex items-center justify-center; }
    .card-custom { @apply bg-gray-800 border border-gray-700 rounded-xl shadow-lg p-6 w-full max-w-lg; }
    .btn-custom { @apply bg-green-500 hover:bg-green-600 active:bg-green-700 text-white font-semibold rounded-lg px-4 py-2 shadow-md transition; }
    .btn-secondary { @apply bg-blue-400 hover:bg-blue-500 active:bg-blue-600; }
    .chip {
      @apply inline-flex items-center justify-center w-16 h-16 bg-indigo-500 text-white rounded-full font-bold text-xl shadow-lg mx-1 my-1;
    }
  </style>
</head>
<body>
  <div class="card-custom text-center">
    <h1 class="text-2xl font-extrabold mb-2">청소당번 랜덤 추첨기</h1>
    <p class="text-gray-400 mb-4">1번부터 30번 사이에서 <strong>중복 없이 5명</strong> 추첨</p>
    <div class="flex justify-center mb-4 space-x-2">
      <button id="drawBtn" class="btn-custom">🎲 뽑기</button>
      <button id="redrawBtn" class="btn-custom btn-secondary">🔁 다시 뽑기</button>
      <button id="copyBtn" class="btn-custom btn-secondary">📋 복사</button>
    </div>
    <div id="result" class="mb-4"></div>
    <p class="text-gray-500 text-sm">Tip: Enter 키로도 다시 뽑기</p>
  </div>

  <!-- SweetAlert2 JS -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <!-- Bootstrap JS Bundle -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    const MIN = 1, MAX = 30, PICK = 5;
    let lastPick = [];

    function range(min, max) {
      return Array.from({ length: max - min + 1 }, (_, i) => i + min);
    }
    function shuffle(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }
    function pickUnique() {
      const arr = shuffle(range(MIN, MAX));
      return arr.slice(0, PICK).sort((a, b) => a - b);
    }
    function renderChips(numbers) {
      const $res = document.getElementById('result');
      $res.innerHTML = numbers.map(n => `<span class="chip">${n}</span>`).join('');
    }
    function copyText(text) {
      return navigator.clipboard ? navigator.clipboard.writeText(text)
        : document.execCommand('copy', false, text);
    }

    async function draw() {
      try {
        const pick = pickUnique();
        lastPick = pick;
        renderChips(pick);
        await Swal.fire({
          icon: 'success',
          iconColor: '#10b981',
          title: '추첨 완료!',
          html: `<p>당번 번호:</p><p><strong>${pick.join(', ')}</strong></p>`,
          showConfirmButton: false,
          timer: 1800,
          background: '#1f2937',
          color: '#e5e7eb',
        });
      } catch (err) {
        await Swal.fire({
          icon: 'error',
          title: '오류',
          text: err.message,
          background: '#1f2937',
          color: '#e5e7eb',
        });
      }
    }

    document.getElementById('drawBtn').addEventListener('click', draw);
    document.getElementById('redrawBtn').addEventListener('click', draw);

    document.getElementById('copyBtn').addEventListener('click', async () => {
      if (!lastPick.length) {
        await Swal.fire({
          icon: 'warning',
          title: '먼저 추첨해주세요!',
          background: '#1f2937',
          color: '#e5e7eb',
        });
        return;
      }
      const text = `청소당번: ${lastPick.join(', ')}`;
      await copyText(text);
      await Swal.fire({
        icon: 'info',
        title: '복사 완료!',
        text: text,
        background: '#1f2937',
        color: '#e5e7eb',
        timer: 1600,
        showConfirmButton: false
      });
    });

    window.addEventListener('keydown', e => {
      if (e.key === 'Enter') draw();
    });

    // 페이지 로드 시 자동 추첨 (원하지 않으면 아래 주석 처리)
    draw();
  </script>
</body>
</html>
